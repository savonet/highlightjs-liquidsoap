# A simple liquidsoap radio script
# @category Source

settings.log.level := 3

%ifdef ENABLE_HARBOR
def my_playlist(~id="playlist", uri) =
  playlist(id=id, uri)
end

live = input.harbor("live", port=8000)
%endif

radio = fallback(track_sensitive=false, [
  live,
  my_playlist("/path/to/music")
])

radio = mksafe(radio)

output.icecast(
  %mp3(bitrate=128),
  host="localhost",
  port=8000,
  password="hackme",
  mount="/radio.mp3",
  radio
)

output.file(%opus(bitrate=192), "/tmp/archive.opus", radio)

let @json.parse data = '{"key": "value"}'
